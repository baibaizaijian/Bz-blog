import{_ as M,a9 as g,v as x,x as N,c as u,o as d,j as v,t as k,F as b,B as y,n as O,e as j,G as B}from"./chunks/framework.BTTXIzTm.js";const C={id:"game"},L={class:"header"},G={class:"score"},U={class:"board"},V=["data-num"],F={key:0,class:"cell-content"},P={__name:"2048",setup(E){const o=g(Array(4).fill(0).map(()=>Array(4).fill(0))),h=g({value:0}),c=g({});function $(){for(let a=0;a<4;a++)for(let r=0;r<4;r++)o[a][r]=0;h.value=0,m(),m(),Object.keys(c).forEach(a=>delete c[a])}function m(){const a=[];if(o.forEach((e,s)=>e.forEach((n,l)=>{n===0&&a.push([s,l])})),!a.length)return;const[r,t]=a[Math.floor(Math.random()*a.length)];o[r][t]=Math.random()<.8?2:4}function _(a){if(!Array.isArray(a))return console.error("slideAndMerge: row is not an array",a),{row:[0,0,0,0],merged:!1};let r=a.filter(e=>e!==0),t=!1;for(let e=0;e<r.length-1;e++)r[e]===r[e+1]&&(r[e]*=2,h.value+=r[e],r[e+1]=0,t=!0);for(r=r.filter(e=>e!==0);r.length<4;)r.push(0);return{row:r,merged:t}}function i(a){return a[0].map((r,t)=>a.map(e=>e[t]))}function p(a){let r=!1,t=o.map(e=>[...e]);switch(Object.keys(c).forEach(e=>delete c[e]),a){case"up":t=i(t),t=t.map((e,s)=>{const n=_(e);return n.merged&&n.row.forEach((l,f)=>{l>0&&(c[`${f}-${s}`]=!0)}),n.row}),t=i(t),t=i(t),t=i(t);break;case"down":t=i(t),t=t.map((e,s)=>{e=[...e].reverse();const n=_(e);return n.merged&&n.row.forEach((l,f)=>{l>0&&(c[`${3-f}-${s}`]=!0)}),n.row.reverse()}),t=i(t),t=i(t),t=i(t);break;case"left":t=t.map((e,s)=>{const n=_(e);return n.merged&&n.row.forEach((l,f)=>{l>0&&(c[`${s}-${f}`]=!0)}),n.row});break;case"right":t=t.map((e,s)=>{e=[...e].reverse();const n=_(e);return n.merged&&n.row.forEach((l,f)=>{l>0&&(c[`${s}-${3-f}`]=!0)}),n.row.reverse()});break}for(let e=0;e<4;e++)for(let s=0;s<4;s++)t[e][s]!==o[e][s]&&(r=!0),o[e][s]=t[e][s];return r}function w(a){let r=!1;switch(a.key){case"ArrowUp":a.preventDefault(),r=p("up");break;case"ArrowDown":a.preventDefault(),r=p("down");break;case"ArrowLeft":a.preventDefault(),r=p("left");break;case"ArrowRight":a.preventDefault(),r=p("right");break}r&&(m(),A()&&setTimeout(()=>alert("你赢了 2048!"),300),D()&&setTimeout(()=>alert("游戏结束!"),300))}function A(){return o.flat().includes(2048)}function D(){if(o.flat().includes(0))return!1;for(let a=0;a<4;a++)for(let r=0;r<4;r++){const t=o[a][r];if(r<3&&o[a][r+1]===t||a<3&&o[a+1][r]===t)return!1}return!0}return x(()=>{m(),m(),window.addEventListener("keydown",w)}),N(()=>{window.removeEventListener("keydown",w)}),(a,r)=>(d(),u("div",C,[v("div",L,[v("div",G,"分数: "+k(h.value),1),v("button",{class:"reset-btn",onClick:$},"重新开始")]),v("div",U,[(d(!0),u(b,null,y(o,(t,e)=>(d(),u("div",{key:e,class:"row"},[(d(!0),u(b,null,y(t,(s,n)=>(d(),u("div",{key:n,class:O(["cell",{"cell-merged":c[`${e}-${n}`]}]),"data-num":s},[s?(d(),u("div",F,k(s),1)):j("",!0)],10,V))),128))]))),128))])]))}},S=M(P,[["__scopeId","data-v-f99ae67c"]]),J=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"posts/2048/index.md","filePath":"posts/2048/index.md","lastUpdated":1756989044000}'),T={name:"posts/2048/index.md"},K=Object.assign(T,{setup(E){return(o,h)=>(d(),u("div",null,[B(S)]))}});export{J as __pageData,K as default};
